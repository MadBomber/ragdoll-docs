
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../development/">
      
      
        <link rel="next" href="../embedding-system/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Document Processing - Ragdoll Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#document-processing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Ragdoll Documentation" class="md-header__button md-logo" aria-label="Ragdoll Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ragdoll Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Document Processing
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Ragdoll Documentation" class="md-nav__button md-logo" aria-label="Ragdoll Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Ragdoll Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ragdoll Documentation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Client API Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jobs Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Services Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../background-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Background Processing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database Schema
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Production Deployment Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Document Processing
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Document Processing
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-parsing-metadata-extraction-and-content-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      File Parsing, Metadata Extraction, and Content Analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-file-types" class="md-nav__link">
    <span class="md-ellipsis">
      Supported File Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported File Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#text-documents" class="md-nav__link">
    <span class="md-ellipsis">
      Text Documents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-documents" class="md-nav__link">
    <span class="md-ellipsis">
      Image Documents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audio-documents-planned" class="md-nav__link">
    <span class="md-ellipsis">
      Audio Documents (Planned)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Processing Pipeline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Processing Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-file-upload-and-validation" class="md-nav__link">
    <span class="md-ellipsis">
      1. File Upload and Validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-format-detection-and-routing" class="md-nav__link">
    <span class="md-ellipsis">
      2. Format Detection and Routing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-content-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      3. Content Extraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-metadata-generation-with-llm" class="md-nav__link">
    <span class="md-ellipsis">
      4. Metadata Generation with LLM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-content-chunking-for-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      5. Content Chunking for Embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-database-storage-and-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      6. Database Storage and Indexing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata Generation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metadata Generation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#llm-based-content-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      LLM-Based Content Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Schema Validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Summary Generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keyword-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      Keyword Extraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#classification-and-tagging" class="md-nav__link">
    <span class="md-ellipsis">
      Classification and Tagging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Background Processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Background Processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#activejob-integration" class="md-nav__link">
    <span class="md-ellipsis">
      ActiveJob Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job-queues-and-workers" class="md-nav__link">
    <span class="md-ellipsis">
      Job Queues and Workers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling-and-retries" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling and Retries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progress-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      Progress Tracking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaling-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Scaling Considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-options" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chunk-size-and-overlap-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Chunk Size and Overlap Settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-selection-for-metadata-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Model Selection for Metadata Generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processing-timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      Processing Timeouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quality-thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      Quality Thresholds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-processing-options" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Processing Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-specific-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Environment-Specific Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../embedding-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedding System
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment-variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Variables Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../extending/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extending the System
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../file-uploads/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Upload System
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation &amp; Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLM Integration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../metadata-schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metadata Schemas
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring &amp; Analytics
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-modal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Modal Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Tuning
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../search-analytics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Search &amp; Analytics
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Considerations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#file-parsing-metadata-extraction-and-content-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      File Parsing, Metadata Extraction, and Content Analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-file-types" class="md-nav__link">
    <span class="md-ellipsis">
      Supported File Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported File Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#text-documents" class="md-nav__link">
    <span class="md-ellipsis">
      Text Documents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image-documents" class="md-nav__link">
    <span class="md-ellipsis">
      Image Documents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audio-documents-planned" class="md-nav__link">
    <span class="md-ellipsis">
      Audio Documents (Planned)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Processing Pipeline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Processing Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-file-upload-and-validation" class="md-nav__link">
    <span class="md-ellipsis">
      1. File Upload and Validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-format-detection-and-routing" class="md-nav__link">
    <span class="md-ellipsis">
      2. Format Detection and Routing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-content-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      3. Content Extraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-metadata-generation-with-llm" class="md-nav__link">
    <span class="md-ellipsis">
      4. Metadata Generation with LLM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-content-chunking-for-embeddings" class="md-nav__link">
    <span class="md-ellipsis">
      5. Content Chunking for Embeddings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-database-storage-and-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      6. Database Storage and Indexing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Metadata Generation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metadata Generation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#llm-based-content-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      LLM-Based Content Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#schema-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Schema Validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Summary Generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keyword-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      Keyword Extraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#classification-and-tagging" class="md-nav__link">
    <span class="md-ellipsis">
      Classification and Tagging
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Background Processing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Background Processing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#activejob-integration" class="md-nav__link">
    <span class="md-ellipsis">
      ActiveJob Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#job-queues-and-workers" class="md-nav__link">
    <span class="md-ellipsis">
      Job Queues and Workers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-handling-and-retries" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling and Retries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#progress-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      Progress Tracking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaling-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Scaling Considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-options" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration Options
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration Options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chunk-size-and-overlap-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Chunk Size and Overlap Settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-selection-for-metadata-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Model Selection for Metadata Generation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processing-timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      Processing Timeouts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quality-thresholds" class="md-nav__link">
    <span class="md-ellipsis">
      Quality Thresholds
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-processing-options" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Processing Options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-specific-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Environment-Specific Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="document-processing">Document Processing</h1>
<p>Ragdoll provides comprehensive document processing capabilities that handle multiple file formats, extract content, and generate intelligent metadata using LLM providers. The system uses a multi-modal Single Table Inheritance (STI) architecture to store different content types efficiently.</p>
<h2 id="file-parsing-metadata-extraction-and-content-analysis">File Parsing, Metadata Extraction, and Content Analysis</h2>
<p>The document processing pipeline transforms raw files into searchable, embedded content through several stages:</p>
<ul>
<li><strong>File Format Detection</strong>: Automatic detection and routing to appropriate parsers</li>
<li><strong>Content Extraction</strong>: Specialized extraction for text, images, and metadata</li>
<li><strong>Multi-Modal STI Storage</strong>: Stores content in specialized models (TextContent, ImageContent, AudioContent)</li>
<li><strong>LLM-Powered Metadata</strong>: AI-generated summaries, keywords, and structured metadata</li>
<li><strong>Vector Embeddings</strong>: Semantic search capabilities through embedding generation</li>
<li><strong>Error Handling</strong>: Robust error recovery and validation at each stage</li>
</ul>
<h2 id="supported-file-types">Supported File Types</h2>
<p>Ragdoll supports a wide range of file formats through specialized parsers:</p>
<h3 id="text-documents">Text Documents</h3>
<p><strong>PDF Processing (<code>pdf-reader</code> gem)</strong>
- Full text extraction from all pages
- Metadata extraction (title, author, subject, creator, producer)
- Creation and modification dates
- Page count and page-by-page processing
- Handles malformed PDFs with graceful error recovery
- Supports password-protected PDFs</p>
<p><strong>DOCX Processing (<code>docx</code> gem)</strong>
- Paragraph text extraction with formatting preservation
- Table content extraction with structure maintained
- Core document properties (title, author, subject, description)
- Keywords and metadata from document properties
- Creation and modification timestamps
- Word and paragraph count statistics</p>
<p><strong>HTML and Markdown Parsing</strong>
- Script and style tag removal for clean content
- HTML tag stripping with whitespace normalization
- Markdown files processed as plain text
- File size and encoding detection
- Preserves content structure and readability</p>
<p><strong>Plain Text Handling</strong>
- UTF-8 encoding with fallback to ISO-8859-1
- File size and encoding metadata
- Direct content preservation without modification
- Supports <code>.txt</code>, <code>.md</code>, <code>.markdown</code> extensions</p>
<h3 id="image-documents">Image Documents</h3>
<p><strong>Supported Formats</strong></p>
<pre><code>.jpg, .jpeg, .png, .gif, .bmp, .webp, .svg, .ico, .tiff, .tif
</code></pre>
<p><strong>Image Processing (ImageMagick/RMagick)</strong>
- Automatic dimension extraction (width Ã— height)
- File size and format metadata
- AI-powered description generation using vision models
- Content stored as descriptive text for search indexing
- Error-resilient processing with fallback descriptions</p>
<p><strong>Vision AI Integration</strong>
- Integrated with <code>ImageDescriptionService</code>
- Configurable vision models (GPT-4 Vision, Claude 3, etc.)
- Generates contextual descriptions for semantic search
- Fallback to filename-based descriptions if AI fails</p>
<h3 id="audio-documents-planned">Audio Documents (Planned)</h3>
<p><strong>Supported Formats (Future)</strong></p>
<pre><code>.mp3, .wav, .flac, .m4a, .ogg, .aac
</code></pre>
<p><strong>Audio Processing (Planned)</strong>
- Speech-to-text transcription using Whisper or similar
- Audio metadata extraction (duration, bitrate, codec)
- Transcript storage in AudioContent models
- Speaker identification and timestamp extraction
- Background job processing for long audio files</p>
<h2 id="processing-pipeline">Processing Pipeline</h2>
<p>The document processing workflow follows a structured six-stage pipeline:</p>
<h3 id="1-file-upload-and-validation">1. File Upload and Validation</h3>
<pre><code class="language-ruby"># File path processing
document = DocumentProcessor.create_document_from_file(
  'path/to/document.pdf',
  title: 'Custom Title',
  metadata: { source: 'import' }
)

# Upload processing (Shrine compatible)
document = DocumentProcessor.create_document_from_upload(
  uploaded_file,
  title: 'Uploaded Document',
  metadata: { user_id: 123 }
)
</code></pre>
<p><strong>Validation Steps:</strong>
- File existence and accessibility verification
- File size limits (configurable)
- Format detection via extension and MIME type
- Permission checks for file access
- Malware scanning (if configured)</p>
<h3 id="2-format-detection-and-routing">2. Format Detection and Routing</h3>
<p><strong>Primary Detection Method:</strong></p>
<pre><code class="language-ruby">def self.determine_document_type(file_path)
  case File.extname(file_path).downcase
  when &quot;.pdf&quot; then &quot;pdf&quot;
  when &quot;.docx&quot; then &quot;docx&quot;
  when &quot;.txt&quot; then &quot;text&quot;
  when &quot;.md&quot;, &quot;.markdown&quot; then &quot;markdown&quot;
  when &quot;.html&quot;, &quot;.htm&quot; then &quot;html&quot;
  when /\.(jpg|jpeg|png|gif|bmp|webp|svg|ico|tiff|tif)$/i then &quot;image&quot;
  else &quot;text&quot;  # Default fallback
  end
end
</code></pre>
<p><strong>Secondary Detection (MIME Type):</strong>
- Used for uploaded files without reliable extensions
- Content-type header analysis
- Magic number detection for binary files
- Fallback to text processing for unknown types</p>
<h3 id="3-content-extraction">3. Content Extraction</h3>
<p><strong>Multi-Modal STI Architecture:</strong></p>
<pre><code class="language-mermaid">graph TD
    A[Document] --&gt; B[TextContent]
    A --&gt; C[ImageContent]
    A --&gt; D[AudioContent]
    B --&gt; E[Text Embeddings]
    C --&gt; F[Image Embeddings]
    D --&gt; G[Audio Embeddings]
</code></pre>
<p><strong>Content Storage Strategy:</strong>
- <strong>TextContent</strong>: Raw text, processed text, word/character counts
- <strong>ImageContent</strong>: AI description, dimensions, file metadata
- <strong>AudioContent</strong>: Transcript, duration, speaker info (planned)
- <strong>Polymorphic Embeddings</strong>: Linked to each content type</p>
<h3 id="4-metadata-generation-with-llm">4. Metadata Generation with LLM</h3>
<p><strong>AI-Powered Analysis:</strong></p>
<pre><code class="language-ruby"># Automatic metadata generation
doc.generate_metadata!

# Generated metadata includes:
# - summary: Concise document summary
# - keywords: Extracted key terms
# - classification: Document category
# - description: Detailed description
# - tags: Topical tags
</code></pre>
<p><strong>Schema Validation:</strong>
- Document type-specific schemas
- Required field validation
- Format and length constraints
- Error handling with fallback values</p>
<h3 id="5-content-chunking-for-embeddings">5. Content Chunking for Embeddings</h3>
<p><strong>TextChunker Integration:</strong></p>
<pre><code class="language-ruby"># Configurable chunking strategy
config.chunking[:text][:max_tokens] = 1000
config.chunking[:text][:overlap] = 200
config.chunking[:text][:strategy] = 'sentence_boundary'
</code></pre>
<p><strong>Chunking Strategies:</strong>
- <strong>Sentence Boundary</strong>: Respects sentence structure
- <strong>Token-Based</strong>: Fixed token count with overlap
- <strong>Paragraph-Based</strong>: Natural paragraph breaks
- <strong>Semantic Chunking</strong>: Content-aware splitting (planned)</p>
<h3 id="6-database-storage-and-indexing">6. Database Storage and Indexing</h3>
<p><strong>PostgreSQL Storage:</strong>
- <strong>Documents</strong>: Main document metadata and status
- <strong>Contents</strong>: STI-based content storage
- <strong>Embeddings</strong>: Vector storage with pgvector
- <strong>Full-text Indexes</strong>: PostgreSQL GIN indexes
- <strong>JSON Metadata</strong>: Structured metadata with indexes</p>
<p><strong>Index Strategy:</strong></p>
<pre><code class="language-sql">-- Full-text search index
CREATE INDEX idx_documents_fulltext ON ragdoll_documents 
USING gin(to_tsvector('english', title || ' ' || 
  COALESCE(metadata-&gt;&gt;'summary', '') || ' ' || 
  COALESCE(metadata-&gt;&gt;'keywords', '')));

-- Vector similarity index
CREATE INDEX idx_embeddings_vector ON ragdoll_embeddings 
USING ivfflat (embedding_vector vector_cosine_ops);
</code></pre>
<h2 id="metadata-generation">Metadata Generation</h2>
<p>Ragdoll uses AI-powered metadata extraction to enhance document searchability and organization:</p>
<h3 id="llm-based-content-analysis">LLM-Based Content Analysis</h3>
<p><strong>MetadataGenerator Service:</strong></p>
<pre><code class="language-ruby">generator = Services::MetadataGenerator.new
metadata = generator.generate_for_document(document)

# Example generated metadata:
{
  &quot;summary&quot; =&gt; &quot;This technical document explains the implementation...&quot;,
  &quot;keywords&quot; =&gt; [&quot;API&quot;, &quot;authentication&quot;, &quot;security&quot;, &quot;OAuth&quot;],
  &quot;classification&quot; =&gt; &quot;technical_documentation&quot;,
  &quot;description&quot; =&gt; &quot;Comprehensive guide to API security practices&quot;,
  &quot;tags&quot; =&gt; [&quot;development&quot;, &quot;security&quot;, &quot;best-practices&quot;],
  &quot;sentiment&quot; =&gt; &quot;neutral&quot;,
  &quot;complexity&quot; =&gt; &quot;intermediate&quot;,
  &quot;estimated_reading_time&quot; =&gt; 15
}
</code></pre>
<p><strong>Configurable LLM Models:</strong></p>
<pre><code class="language-ruby"># Different models for different tasks
config.summarization_config[:model] = 'openai/gpt-4o'
config.keywords_config[:model] = 'anthropic/claude-3-haiku-20240307'
config.classification_config[:model] = 'openai/gpt-4o-mini'
</code></pre>
<h3 id="schema-validation">Schema Validation</h3>
<p><strong>Document Type-Specific Schemas:</strong></p>
<pre><code class="language-ruby"># Text document schema
MetadataSchemas::TEXT_SCHEMA = {
  summary: { type: :string, required: true, max_length: 500 },
  keywords: { type: :array, items: :string, max_items: 20 },
  classification: { type: :string, enum: CLASSIFICATIONS },
  description: { type: :string, max_length: 1000 },
  tags: { type: :array, items: :string, max_items: 10 }
}

# Image document schema
MetadataSchemas::IMAGE_SCHEMA = {
  description: { type: :string, required: true },
  objects_detected: { type: :array, items: :string },
  scene_type: { type: :string },
  colors: { type: :array, items: :string },
  text_content: { type: :string }  # OCR results
}
</code></pre>
<p><strong>Validation Process:</strong></p>
<pre><code class="language-ruby">errors = MetadataSchemas.validate_metadata(document_type, metadata)
if errors.any?
  Rails.logger.warn &quot;Metadata validation errors: #{errors.join(', ')}&quot;
  # Apply fallback values for failed fields
end
</code></pre>
<h3 id="summary-generation">Summary Generation</h3>
<p><strong>Configurable Summary Strategy:</strong></p>
<pre><code class="language-ruby">config.summarization_config.tap do |c|
  c[:enable] = true
  c[:model] = 'openai/gpt-4o'
  c[:max_length] = 300
  c[:style] = 'concise'  # concise, detailed, bullet_points
  c[:include_keywords] = true
end
</code></pre>
<p><strong>Content-Aware Summarization:</strong>
- <strong>Technical Documents</strong>: Focus on key concepts and procedures
- <strong>Legal Documents</strong>: Highlight important clauses and obligations
- <strong>Academic Papers</strong>: Emphasize methodology and findings
- <strong>General Content</strong>: Extract main themes and conclusions</p>
<h3 id="keyword-extraction">Keyword Extraction</h3>
<p><strong>Multi-Strategy Keyword Extraction:</strong></p>
<pre><code class="language-ruby"># LLM-based extraction
llm_keywords = extract_keywords_with_llm(content)

# Statistical extraction (TF-IDF)
stats_keywords = extract_keywords_statistical(content)

# Hybrid approach combining both
final_keywords = merge_keyword_strategies(
  llm_keywords, 
  stats_keywords,
  weights: { llm: 0.7, statistical: 0.3 }
)
</code></pre>
<p><strong>Keyword Quality Filtering:</strong>
- Minimum length requirements (&gt;3 characters)
- Stop word removal
- Duplicate detection and merging
- Relevance scoring
- Maximum keyword limits (configurable)</p>
<h3 id="classification-and-tagging">Classification and Tagging</h3>
<p><strong>Hierarchical Classification:</strong></p>
<pre><code class="language-ruby">CLASSIFICATIONS = {
  'technical_documentation' =&gt; {
    'api_documentation' =&gt; ['rest', 'graphql', 'rpc'],
    'user_guides' =&gt; ['tutorial', 'how-to', 'reference'],
    'architecture' =&gt; ['design', 'patterns', 'infrastructure']
  },
  'business_documents' =&gt; {
    'contracts' =&gt; ['nda', 'service_agreement', 'license'],
    'reports' =&gt; ['financial', 'quarterly', 'analysis'],
    'procedures' =&gt; ['policy', 'workflow', 'compliance']
  }
}
</code></pre>
<p><strong>Smart Tagging System:</strong></p>
<pre><code class="language-ruby"># Auto-generated tags based on content analysis
auto_tags = [
  content_based_tags,      # From text analysis
  format_based_tags,       # From document format
  metadata_based_tags,     # From existing metadata
  context_based_tags       # From file location/name
].flatten.uniq

# User-defined tags (preserved and merged)
final_tags = (user_tags + auto_tags).uniq
</code></pre>
<p><strong>Tag Confidence Scoring:</strong>
- High confidence: Direct content matches
- Medium confidence: Contextual indicators
- Low confidence: Statistical correlations
- Threshold-based filtering for quality control</p>
<h2 id="background-processing">Background Processing</h2>
<p>Ragdoll uses background jobs for resource-intensive processing operations:</p>
<h3 id="activejob-integration">ActiveJob Integration</h3>
<p><strong>Available Background Jobs:</strong></p>
<pre><code class="language-ruby"># Text extraction job
Ragdoll::Core::Jobs::ExtractText.perform_later(document_id)

# Embedding generation job
Ragdoll::Core::Jobs::GenerateEmbeddings.perform_later(content_id, content_type)

# Summary generation job
Ragdoll::Core::Jobs::GenerateSummary.perform_later(document_id)

# Keyword extraction job
Ragdoll::Core::Jobs::ExtractKeywords.perform_later(document_id)
</code></pre>
<p><strong>Job Configuration:</strong></p>
<pre><code class="language-ruby">config.background_processing_config.tap do |c|
  c[:enable] = true
  c[:queue_name] = 'ragdoll_processing'
  c[:job_timeout] = 300.seconds
  c[:max_retry_attempts] = 3
  c[:retry_backoff] = :exponential
end
</code></pre>
<h3 id="job-queues-and-workers">Job Queues and Workers</h3>
<p><strong>Queue Priority System:</strong></p>
<pre><code class="language-ruby"># High priority: User-facing operations
queue_as :ragdoll_high_priority, priority: 10

# Medium priority: Batch processing
queue_as :ragdoll_medium_priority, priority: 5

# Low priority: Background optimization
queue_as :ragdoll_low_priority, priority: 1
</code></pre>
<p><strong>Worker Scaling Configuration:</strong></p>
<pre><code class="language-bash"># Development: Single worker
bundle exec sidekiq -q ragdoll_processing

# Production: Multiple workers with priority queues
bundle exec sidekiq -q ragdoll_high_priority:3 -q ragdoll_medium_priority:2 -q ragdoll_low_priority:1
</code></pre>
<h3 id="error-handling-and-retries">Error Handling and Retries</h3>
<p><strong>Retry Strategy:</strong></p>
<pre><code class="language-ruby">class ProcessDocumentJob &lt; ApplicationJob
  retry_on StandardError, wait: :exponentially_longer, attempts: 3
  retry_on ActiveRecord::Deadlocked, wait: 5.seconds, attempts: 3

  discard_on ActiveJob::DeserializationError
  discard_on Ragdoll::Core::UnsupportedFormatError

  def perform(document_id)
    document = Document.find(document_id)
    document.process_content!
  rescue =&gt; e
    document&amp;.update(status: 'error', error_message: e.message)
    raise
  end
end
</code></pre>
<p><strong>Error Recovery:</strong>
- Automatic retries with exponential backoff
- Dead letter queue for failed jobs
- Error notification system
- Manual job retry capabilities
- Partial processing recovery</p>
<h3 id="progress-tracking">Progress Tracking</h3>
<p><strong>Job Status Monitoring:</strong></p>
<pre><code class="language-ruby"># Document processing status
document.status  # 'pending', 'processing', 'processed', 'error'

# Detailed progress tracking
processing_info = {
  stage: 'embedding_generation',
  progress: 75,
  total_steps: 4,
  current_step: 3,
  estimated_completion: 2.minutes.from_now
}

document.update(processing_info: processing_info)
</code></pre>
<p><strong>Real-time Updates:</strong></p>
<pre><code class="language-ruby"># WebSocket integration for live progress
ActionCable.server.broadcast(
  &quot;document_#{document.id}&quot;,
  {
    event: 'processing_update',
    progress: 50,
    message: 'Generating embeddings...'
  }
)
</code></pre>
<h3 id="scaling-considerations">Scaling Considerations</h3>
<p><strong>Horizontal Scaling:</strong></p>
<pre><code class="language-yaml"># Docker Compose example
services:
  ragdoll_worker_1:
    build: .
    command: bundle exec sidekiq -q ragdoll_high_priority:2
    environment:
      - REDIS_URL=redis://redis:6379/0

  ragdoll_worker_2:
    build: .
    command: bundle exec sidekiq -q ragdoll_medium_priority:3 -q ragdoll_low_priority:1
    environment:
      - REDIS_URL=redis://redis:6379/0
</code></pre>
<p><strong>Resource Management:</strong></p>
<pre><code class="language-ruby"># Memory-aware job processing
class ProcessLargeDocumentJob &lt; ApplicationJob
  def perform(document_id)
    # Process in chunks to manage memory
    document = Document.find(document_id)

    if document.file_size &gt; 50.megabytes
      process_in_chunks(document)
    else
      process_normally(document)
    end
  ensure
    GC.start  # Force garbage collection
  end
end
</code></pre>
<p><strong>Performance Monitoring:</strong></p>
<pre><code class="language-ruby"># Job performance metrics
class JobMetrics
  def self.track_job_performance(job_name, &amp;block)
    start_time = Time.current
    result = block.call
    duration = Time.current - start_time

    Rails.logger.info &quot;Job #{job_name} completed in #{duration}s&quot;

    # Send to monitoring service
    StatsD.histogram('job.duration', duration, tags: [&quot;job:#{job_name}&quot;])

    result
  end
end
</code></pre>
<h2 id="configuration-options">Configuration Options</h2>
<p>Ragdoll provides extensive configuration options for document processing:</p>
<h3 id="chunk-size-and-overlap-settings">Chunk Size and Overlap Settings</h3>
<p><strong>Text Chunking Configuration:</strong></p>
<pre><code class="language-ruby">Ragdoll::Core.configure do |config|
  config.chunking[:text].tap do |c|
    c[:max_tokens] = 1000           # Maximum tokens per chunk
    c[:overlap] = 200               # Token overlap between chunks
    c[:strategy] = 'sentence'       # 'sentence', 'paragraph', 'token'
    c[:min_chunk_size] = 100        # Minimum viable chunk size
    c[:preserve_paragraphs] = true  # Respect paragraph boundaries
    c[:split_on_headers] = true     # Split at header boundaries
  end
end
</code></pre>
<p><strong>Content-Type Specific Chunking:</strong></p>
<pre><code class="language-ruby"># PDF documents (technical content)
config.chunking[:pdf][:max_tokens] = 1500
config.chunking[:pdf][:overlap] = 300
config.chunking[:pdf][:preserve_page_breaks] = true

# HTML documents (web content)
config.chunking[:html][:max_tokens] = 800
config.chunking[:html][:overlap] = 150
config.chunking[:html][:preserve_structure] = true

# Code documents
config.chunking[:code][:max_tokens] = 2000
config.chunking[:code][:overlap] = 100
config.chunking[:code][:preserve_functions] = true
</code></pre>
<h3 id="model-selection-for-metadata-generation">Model Selection for Metadata Generation</h3>
<p><strong>LLM Model Configuration:</strong></p>
<pre><code class="language-ruby">config.ruby_llm_config.tap do |llm|
  # Primary models for different tasks
  llm[:openai][:api_key] = ENV['OPENAI_API_KEY']
  llm[:anthropic][:api_key] = ENV['ANTHROPIC_API_KEY']
  llm[:google][:api_key] = ENV['GOOGLE_API_KEY']
end

# Task-specific model assignment
config.models.tap do |m|
  m[:summarization] = 'openai/gpt-4o'           # Best for summaries
  m[:keywords] = 'anthropic/claude-3-haiku'     # Fast keyword extraction
  m[:classification] = 'openai/gpt-4o-mini'     # Cost-effective classification
  m[:description] = 'google/gemini-1.5-pro'    # Detailed descriptions
end
</code></pre>
<p><strong>Embedding Model Configuration:</strong></p>
<pre><code class="language-ruby">config.embedding_config.tap do |e|
  # Text embeddings
  e[:text][:model] = 'openai/text-embedding-3-large'
  e[:text][:dimensions] = 3072
  e[:text][:batch_size] = 100

  # Image embeddings (planned)
  e[:image][:model] = 'openai/clip-vit-large-patch14'
  e[:image][:dimensions] = 768

  # Audio embeddings (planned)
  e[:audio][:model] = 'openai/whisper-embedding-v1'
  e[:audio][:dimensions] = 1024
end
</code></pre>
<h3 id="processing-timeouts">Processing Timeouts</h3>
<p><strong>Timeout Configuration:</strong></p>
<pre><code class="language-ruby">config.processing_timeouts.tap do |t|
  # Per-operation timeouts
  t[:file_parsing] = 120.seconds        # File content extraction
  t[:text_extraction] = 60.seconds      # Text processing
  t[:image_analysis] = 180.seconds      # Vision AI processing
  t[:metadata_generation] = 300.seconds # LLM metadata creation
  t[:embedding_generation] = 240.seconds # Vector embedding creation

  # Document size-based scaling
  t[:scaling_factor] = 1.5              # Multiply timeout by this for large docs
  t[:large_document_threshold] = 10.megabytes
end
</code></pre>
<p><strong>Background Job Timeouts:</strong></p>
<pre><code class="language-ruby">config.background_processing_config.tap do |bg|
  bg[:job_timeout] = 600.seconds        # Maximum job execution time
  bg[:queue_timeout] = 3600.seconds     # Maximum time in queue
  bg[:retry_timeout] = 1800.seconds     # Time between retries
end
</code></pre>
<h3 id="quality-thresholds">Quality Thresholds</h3>
<p><strong>Content Quality Filters:</strong></p>
<pre><code class="language-ruby">config.quality_thresholds.tap do |q|
  # Minimum content requirements
  q[:min_text_length] = 50              # Minimum characters for processing
  q[:min_word_count] = 10               # Minimum words for meaningful content
  q[:max_empty_lines_ratio] = 0.5       # Maximum ratio of empty lines

  # Metadata quality requirements
  q[:min_summary_length] = 20           # Minimum summary length
  q[:max_summary_length] = 500          # Maximum summary length
  q[:min_keywords_count] = 3            # Minimum number of keywords
  q[:max_keywords_count] = 20           # Maximum number of keywords

  # Embedding quality thresholds
  q[:min_embedding_similarity] = 0.1    # Minimum similarity for relevance
  q[:duplicate_threshold] = 0.95        # Similarity threshold for duplicates
end
</code></pre>
<p><strong>Language Detection and Filtering:</strong></p>
<pre><code class="language-ruby">config.language_config.tap do |l|
  l[:enabled] = true
  l[:supported_languages] = ['en', 'es', 'fr', 'de', 'it']
  l[:confidence_threshold] = 0.8         # Minimum language detection confidence
  l[:fallback_language] = 'en'          # Default when detection fails
  l[:skip_unsupported] = false          # Process unsupported languages as text
end
</code></pre>
<h3 id="advanced-processing-options">Advanced Processing Options</h3>
<p><strong>Performance Optimization:</strong></p>
<pre><code class="language-ruby">config.performance_config.tap do |p|
  # Parallel processing
  p[:parallel_processing] = true
  p[:max_parallel_jobs] = 4
  p[:chunk_processing_batch_size] = 50

  # Memory management
  p[:memory_limit] = 2.gigabytes
  p[:gc_frequency] = 100               # GC every N operations
  p[:temp_file_cleanup] = true

  # Caching
  p[:cache_parsed_content] = true
  p[:cache_embeddings] = true
  p[:cache_ttl] = 1.hour
end
</code></pre>
<p><strong>Error Handling Configuration:</strong></p>
<pre><code class="language-ruby">config.error_handling.tap do |e|
  e[:continue_on_parse_error] = true    # Continue processing other content
  e[:retry_failed_chunks] = true       # Retry failed chunk processing
  e[:max_retry_attempts] = 3           # Maximum retry attempts
  e[:fallback_to_text] = true          # Fallback to text processing
  e[:notify_on_errors] = true          # Send error notifications
end
</code></pre>
<h3 id="environment-specific-configuration">Environment-Specific Configuration</h3>
<p><strong>Development Settings:</strong></p>
<pre><code class="language-ruby">if Rails.env.development?
  config.chunking[:text][:max_tokens] = 500    # Smaller chunks for faster processing
  config.processing_timeouts[:metadata_generation] = 60.seconds
  config.background_processing_config[:enable] = false  # Synchronous processing
end
</code></pre>
<p><strong>Production Settings:</strong></p>
<pre><code class="language-ruby">if Rails.env.production?
  config.chunking[:text][:max_tokens] = 1500   # Larger chunks for efficiency
  config.background_processing_config[:enable] = true
  config.performance_config[:parallel_processing] = true
  config.quality_thresholds[:min_text_length] = 100
end
</code></pre>
<hr />
<p><em>This document is part of the Ragdoll documentation suite. For immediate help, see the <a href="../quick-start/">Quick Start Guide</a> or <a href="../api-client/">API Reference</a>.</em></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>