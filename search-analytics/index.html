
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../quick-start/">
      
      
        <link rel="next" href="../security/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Search & Analytics - Ragdoll Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#search-analytics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Ragdoll Documentation" class="md-header__button md-logo" aria-label="Ragdoll Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ragdoll Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Search &amp; Analytics
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Ragdoll Documentation" class="md-nav__button md-logo" aria-label="Ragdoll Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Ragdoll Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ragdoll Documentation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Client API Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-jobs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jobs Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Services Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../background-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Background Processing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../database-schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Database Schema
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Production Deployment Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../document-processing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Document Processing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../embedding-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedding System
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment-variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Environment Variables Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../extending/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extending the System
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../file-uploads/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Upload System
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation &amp; Setup
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../llm-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLM Integration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../metadata-schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metadata Schemas
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../monitoring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monitoring &amp; Analytics
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi-modal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Modal Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Tuning
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Search &amp; Analytics
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Search &amp; Analytics
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#searchengine-core" class="md-nav__link">
    <span class="md-ellipsis">
      SearchEngine Core
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Database Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#semantic-search" class="md-nav__link">
    <span class="md-ellipsis">
      Semantic Search
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Semantic Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vector-similarity-search" class="md-nav__link">
    <span class="md-ellipsis">
      Vector Similarity Search
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-modal-search" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Modal Search
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hybrid-search" class="md-nav__link">
    <span class="md-ellipsis">
      Hybrid Search
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hybrid Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture_1" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-hybrid-search-works" class="md-nav__link">
    <span class="md-ellipsis">
      How Hybrid Search Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keyword-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      Keyword Extraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smart-ranking-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Smart Ranking Algorithm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-text-search-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Full-Text Search Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Full-Text Search Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#postgresql-full-text-search" class="md-nav__link">
    <span class="md-ellipsis">
      PostgreSQL Full-Text Search
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-search-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Search Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Search Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#faceted-search" class="md-nav__link">
    <span class="md-ellipsis">
      Faceted Search
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search-suggestions-and-autocomplete" class="md-nav__link">
    <span class="md-ellipsis">
      Search Suggestions and Autocomplete
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analytics-and-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      Analytics and Reporting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analytics and Reporting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#search-analytics-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Search Analytics Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-performance-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Query Performance Monitoring
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-integration" class="md-nav__link">
    <span class="md-ellipsis">
      API Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#search-api-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      Search API Endpoints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#search-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Search Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices_1" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-search-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      1. Search Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-analytics-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Analytics Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-ranking-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      3. Ranking Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-performance-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      4. Performance Scaling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Considerations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#searchengine-core" class="md-nav__link">
    <span class="md-ellipsis">
      SearchEngine Core
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Database Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#semantic-search" class="md-nav__link">
    <span class="md-ellipsis">
      Semantic Search
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Semantic Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vector-similarity-search" class="md-nav__link">
    <span class="md-ellipsis">
      Vector Similarity Search
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-modal-search" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Modal Search
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hybrid-search" class="md-nav__link">
    <span class="md-ellipsis">
      Hybrid Search
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hybrid Search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture_1" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-hybrid-search-works" class="md-nav__link">
    <span class="md-ellipsis">
      How Hybrid Search Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keyword-extraction" class="md-nav__link">
    <span class="md-ellipsis">
      Keyword Extraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smart-ranking-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Smart Ranking Algorithm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-text-search-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Full-Text Search Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Full-Text Search Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#postgresql-full-text-search" class="md-nav__link">
    <span class="md-ellipsis">
      PostgreSQL Full-Text Search
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-search-features" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Search Features
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Search Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#faceted-search" class="md-nav__link">
    <span class="md-ellipsis">
      Faceted Search
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search-suggestions-and-autocomplete" class="md-nav__link">
    <span class="md-ellipsis">
      Search Suggestions and Autocomplete
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analytics-and-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      Analytics and Reporting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Analytics and Reporting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#search-analytics-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Search Analytics Dashboard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-performance-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Query Performance Monitoring
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-integration" class="md-nav__link">
    <span class="md-ellipsis">
      API Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#search-api-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      Search API Endpoints
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#search-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Search Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices_1" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-search-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      1. Search Optimization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-analytics-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      2. Analytics Implementation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-ranking-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      3. Ranking Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-performance-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      4. Performance Scaling
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="search-analytics">Search &amp; Analytics</h1>
<p>Ragdoll implements a sophisticated search and analytics system that goes far beyond basic semantic similarity. The system combines vector search with usage analytics, full-text search capabilities, and intelligent ranking algorithms to provide enterprise-grade search functionality.</p>
<h2 id="overview">Overview</h2>
<p>The search system consists of several integrated components:</p>
<ul>
<li><strong>Semantic Search</strong>: pgvector-powered similarity search with cosine distance</li>
<li><strong>Usage Analytics</strong>: Frequency and recency-based ranking algorithms</li>
<li><strong>Full-Text Search</strong>: PostgreSQL GIN indexes with tsquery support</li>
<li><strong>Cross-Modal Search</strong>: Unified search across text, image, and audio content</li>
<li><strong>Hybrid Search</strong>: Combining semantic and full-text search with keyword extraction</li>
<li><strong>Keyword Extraction</strong>: Intelligent keyword extraction for enhanced search relevance</li>
<li><strong>Smart Ranking</strong>: Usage patterns, similarity scores, and metadata weighting</li>
</ul>
<h2 id="architecture">Architecture</h2>
<h3 id="searchengine-core">SearchEngine Core</h3>
<pre><code class="language-ruby">class SearchEngine
  def search_similar_content(query, options = {})
    # 1. Generate query embedding
    query_vector = EmbeddingService.generate_embedding(query)

    # 2. Perform vector similarity search
    similar_embeddings = find_similar_embeddings(
      query_vector, 
      options[:similarity_threshold] || Configuration.search_similarity_threshold,
      options[:limit] || Configuration.max_search_results
    )

    # 3. Apply usage-based ranking
    ranked_results = apply_usage_ranking(similar_embeddings, options)

    # 4. Enhance with metadata and formatting
    format_search_results(ranked_results, options)
  end
end
</code></pre>
<h3 id="database-optimization">Database Optimization</h3>
<pre><code class="language-sql">-- Optimized pgvector indexes for fast similarity search
CREATE INDEX idx_embeddings_vector_cosine 
ON ragdoll_embeddings 
USING ivfflat (embedding_vector vector_cosine_ops) 
WITH (lists = 100);

-- Usage analytics indexes
CREATE INDEX idx_embeddings_usage_analytics 
ON ragdoll_embeddings (usage_count DESC, returned_at DESC);

-- Polymorphic content type indexes
CREATE INDEX idx_embeddings_content_type 
ON ragdoll_embeddings (embeddable_type, embeddable_id);

-- Full-text search indexes
CREATE INDEX idx_embeddings_content_fulltext 
ON ragdoll_embeddings 
USING GIN (to_tsvector('english', content));
</code></pre>
<h2 id="semantic-search">Semantic Search</h2>
<h3 id="vector-similarity-search">Vector Similarity Search</h3>
<pre><code class="language-ruby"># Core similarity search implementation
def find_similar_embeddings(query_vector, threshold, limit)
  Embedding.select(
    &quot;*, &quot; \
    &quot;embedding_vector &lt;=&gt; '#{query_vector}' as distance, &quot; \
    &quot;1 - (embedding_vector &lt;=&gt; '#{query_vector}') as similarity&quot;
  )
  .where(&quot;1 - (embedding_vector &lt;=&gt; '#{query_vector}') &gt;= ?&quot;, threshold)
  .order(&quot;embedding_vector &lt;=&gt; '#{query_vector}'&quot;)
  .limit(limit)
end

# Usage example
results = SearchEngine.search_similar_content(
  &quot;machine learning algorithms&quot;,
  similarity_threshold: 0.8,
  limit: 20
)
</code></pre>
<h3 id="multi-modal-search">Multi-Modal Search</h3>
<pre><code class="language-ruby"># Search across all content types
def cross_modal_search(query, content_types: nil)
  base_query = Embedding.joins(:embeddable)

  if content_types.present?
    base_query = base_query.where(embeddable_type: content_types.map(&amp;:classify))
  end

  # Generate embeddings and search
  query_vector = EmbeddingService.generate_embedding(query)

  base_query.select(
    &quot;ragdoll_embeddings.*, &quot; \
    &quot;embedding_vector &lt;=&gt; '#{query_vector}' as distance, &quot; \
    &quot;embeddable_type as content_type&quot;
  )
  .where(&quot;1 - (embedding_vector &lt;=&gt; '#{query_vector}') &gt;= ?&quot;, similarity_threshold)
  .order(&quot;embedding_vector &lt;=&gt; '#{query_vector}'&quot;)
end

# Search specific content types
text_results = SearchEngine.search_similar_content(
  &quot;neural networks&quot;,
  content_types: ['text']
)

image_results = SearchEngine.search_similar_content(
  &quot;architecture diagram&quot;, 
  content_types: ['image']
)

# Combined cross-modal search
all_results = SearchEngine.search_similar_content(
  &quot;deep learning concepts&quot;,
  content_types: ['text', 'image', 'audio']
)
</code></pre>
<h2 id="hybrid-search">Hybrid Search</h2>
<p>Ragdoll's hybrid search combines semantic vector search with keyword-based full-text search to provide more comprehensive and relevant results.</p>
<h3 id="architecture_1">Architecture</h3>
<pre><code class="language-ruby"># High-level hybrid search interface
results = Ragdoll::Core.hybrid_search(
  query: &quot;neural networks and deep learning&quot;,
  semantic_weight: 0.7,    # Weight for vector similarity (0.0 - 1.0)
  text_weight: 0.3,        # Weight for full-text search (0.0 - 1.0)
  limit: 20
)
</code></pre>
<h3 id="how-hybrid-search-works">How Hybrid Search Works</h3>
<ol>
<li><strong>Query Processing</strong>: The input query is processed through both semantic and lexical pipelines</li>
<li><strong>Keyword Extraction</strong>: Keywords are extracted from the query using <code>extract_keywords</code></li>
<li><strong>Semantic Search</strong>: Vector embeddings are generated and similarity search is performed</li>
<li><strong>Full-Text Search</strong>: PostgreSQL full-text search using GIN indexes</li>
<li><strong>Result Combination</strong>: Results are merged with configurable weighting</li>
<li><strong>Ranking</strong>: Combined scores determine final result ordering</li>
</ol>
<h3 id="implementation-details">Implementation Details</h3>
<pre><code class="language-ruby">class Document &lt; ActiveRecord::Base
  # Extract keywords from query string (words &gt; 4 characters)
  def self.extract_keywords(query:)
    return [] if query.nil? || query.strip.empty?

    query.split(/\s+/)
         .map(&amp;:strip)
         .reject(&amp;:empty?)
         .select { |word| word.length &gt; 4 }
  end

  # Hybrid search combining semantic and full-text approaches
  def self.hybrid_search(query, query_embedding: nil, **options)
    limit = options[:limit] || 20
    semantic_weight = options[:semantic_weight] || 0.7
    text_weight = options[:text_weight] || 0.3

    results = []

    # Get semantic search results if embedding provided
    if query_embedding
      semantic_results = embeddings_search(query_embedding, limit: limit)
      results.concat(semantic_results.map do |result|
        result.merge(
          search_type: 'semantic',
          weighted_score: result[:combined_score] * semantic_weight
        )
      end)
    end

    # Get PostgreSQL full-text search results
    text_results = search_content(query, limit: limit)
    text_results.each_with_index do |doc, index|
      score = (limit - index).to_f / limit * text_weight
      results &lt;&lt; {
        document_id: doc.id.to_s,
        document_title: doc.title,
        content: doc.content[0..500],
        search_type: 'full_text',
        weighted_score: score,
        document: doc
      }
    end

    # Combine and deduplicate by document_id
    combined = results.group_by { |r| r[:document_id] }
                      .map do |_doc_id, doc_results|
      best_result = doc_results.max_by { |r| r[:weighted_score] }
      total_score = doc_results.sum { |r| r[:weighted_score] }
      search_types = doc_results.map { |r| r[:search_type] }.uniq

      best_result.merge(
        combined_score: total_score,
        search_types: search_types
      )
    end

    combined.sort_by { |r| -r[:combined_score] }.take(limit)
  end
end
</code></pre>
<h3 id="usage-examples">Usage Examples</h3>
<pre><code class="language-ruby"># Basic hybrid search
results = client.hybrid_search(
  query: &quot;machine learning algorithms for text processing&quot;
)

# Emphasize semantic similarity
results = client.hybrid_search(
  query: &quot;neural network architectures&quot;,
  semantic_weight: 0.8,
  text_weight: 0.2
)

# Emphasize keyword matching
results = client.hybrid_search(
  query: &quot;specific technical term&quot;,
  semantic_weight: 0.3,
  text_weight: 0.7
)

# Large result set for comprehensive analysis
results = client.hybrid_search(
  query: &quot;artificial intelligence research&quot;,
  limit: 50,
  semantic_weight: 0.6,
  text_weight: 0.4
)
</code></pre>
<h3 id="keyword-extraction">Keyword Extraction</h3>
<p>The <code>extract_keywords</code> method intelligently identifies significant terms from search queries:</p>
<pre><code class="language-ruby"># Extract meaningful keywords from queries
keywords = Ragdoll::Core::Models::Document.extract_keywords(
  query: &quot;machine learning algorithms neural networks&quot;
)
# Returns: [&quot;machine&quot;, &quot;learning&quot;, &quot;algorithms&quot;, &quot;neural&quot;, &quot;networks&quot;]

# Handles punctuation and formatting
keywords = Ragdoll::Core::Models::Document.extract_keywords(
  query: &quot;deep-learning, artificial-intelligence!&quot;
)  
# Returns: [&quot;deep-learning,&quot;, &quot;artificial-intelligence!&quot;]

# Filters short words automatically
keywords = Ragdoll::Core::Models::Document.extract_keywords(
  query: &quot;AI and ML for big data analysis&quot;
)
# Returns: [&quot;analysis&quot;] # Only words &gt; 4 characters
</code></pre>
<h3 id="best-practices">Best Practices</h3>
<p><strong>Query Optimization</strong>:
- Use descriptive queries with both specific terms and conceptual language
- For technical searches, use higher text weights to prioritize exact matches
- For conceptual searches, use higher semantic weights for broader relevance</p>
<p><strong>Weight Configuration</strong>:
- <strong>Semantic-Heavy (0.8/0.2)</strong>: Conceptual searches, exploratory research
- <strong>Balanced (0.6/0.4)</strong>: General purpose searches, mixed content
- <strong>Text-Heavy (0.3/0.7)</strong>: Technical documentation, specific term searches</p>
<p><strong>Performance Considerations</strong>:
- Hybrid search is more computationally expensive than single-mode search
- Consider caching frequently used query patterns
- Use appropriate limits to balance comprehensiveness with performance</p>
<pre><code>
## Usage Analytics

### Analytics Data Collection

```ruby
class Embedding &lt; ApplicationRecord
  # Automatic usage tracking
  after_find :track_usage, if: :search_context?

  def track_usage
    increment!(:usage_count)
    update_column(:returned_at, Time.current)

    # Record detailed analytics
    SearchAnalytics.record_access(
      embedding: self,
      query: current_search_query,
      user_id: current_user_id,
      session_id: current_session_id,
      timestamp: Time.current
    )
  end

  # Usage-based scoring
  def usage_score
    recency_score = calculate_recency_score
    frequency_score = calculate_frequency_score

    (recency_score * 0.3) + (frequency_score * 0.7)
  end

  private

  def calculate_recency_score
    return 0 unless returned_at

    days_since = (Time.current - returned_at) / 1.day
    Math.exp(-days_since / 30.0)  # Exponential decay over 30 days
  end

  def calculate_frequency_score
    return 0 if usage_count.zero?

    # Logarithmic scaling for usage frequency
    Math.log(usage_count + 1) / Math.log(100)  # Max score at 100 uses
  end
end
</code></pre>
<h3 id="smart-ranking-algorithm">Smart Ranking Algorithm</h3>
<pre><code class="language-ruby">class SearchRanker
  def rank_results(embeddings, options = {})
    embeddings.map do |embedding|
      {
        embedding: embedding,
        similarity_score: embedding.similarity,
        usage_score: embedding.usage_score,
        metadata_score: calculate_metadata_score(embedding, options),
        composite_score: calculate_composite_score(embedding, options)
      }
    end.sort_by { |result| -result[:composite_score] }
  end

  private

  def calculate_composite_score(embedding, options)
    weights = options[:ranking_weights] || default_weights

    similarity_weight = weights[:similarity] || 0.6
    usage_weight = weights[:usage] || 0.3
    metadata_weight = weights[:metadata] || 0.1

    (embedding.similarity * similarity_weight) +
    (embedding.usage_score * usage_weight) +
    (calculate_metadata_score(embedding, options) * metadata_weight)
  end

  def calculate_metadata_score(embedding, options)
    document = embedding.embeddable.document
    score = 0.0

    # Boost recent documents
    if document.created_at &gt; 30.days.ago
      score += 0.2
    end

    # Boost documents with rich metadata
    if document.metadata&amp;.key?('classification')
      score += 0.1
    end

    # Classification matching
    if options[:preferred_classification] &amp;&amp; 
       document.metadata&amp;.dig('classification') == options[:preferred_classification]
      score += 0.3
    end

    # Topic relevance scoring
    if options[:topic_filters].present? &amp;&amp; document.metadata&amp;.key?('topics')
      overlap = (options[:topic_filters] &amp; document.metadata['topics']).size
      score += (overlap.to_f / options[:topic_filters].size) * 0.4
    end

    [score, 1.0].min  # Cap at 1.0
  end
end
</code></pre>
<h2 id="full-text-search-integration">Full-Text Search Integration</h2>
<h3 id="postgresql-full-text-search">PostgreSQL Full-Text Search</h3>
<pre><code class="language-ruby">class HybridSearchEngine
  def hybrid_search(query, semantic_weight: 0.7, text_weight: 0.3, options: {})
    # 1. Semantic search results
    semantic_results = semantic_search(query, options)

    # 2. Full-text search results
    fulltext_results = fulltext_search(query, options)

    # 3. Combine and weight results
    combine_search_results(
      semantic_results, 
      fulltext_results,
      semantic_weight: semantic_weight,
      text_weight: text_weight
    )
  end

  private

  def fulltext_search(query, options)
    # PostgreSQL full-text search with ranking
    Embedding.select(
      &quot;*, &quot; \
      &quot;ts_rank(to_tsvector('english', content), plainto_tsquery('english', ?)) as text_rank&quot;
    )
    .where(&quot;to_tsvector('english', content) @@ plainto_tsquery('english', ?)&quot;, query)
    .where(&quot;ts_rank(to_tsvector('english', content), plainto_tsquery('english', ?)) &gt; 0.1&quot;, query)
    .order(&quot;text_rank DESC&quot;)
    .limit(options[:limit] || 50)
  end

  def combine_search_results(semantic_results, fulltext_results, weights)
    all_results = {}

    # Add semantic results with weighting
    semantic_results.each do |result|
      all_results[result.id] = {
        embedding: result,
        semantic_score: result.similarity * weights[:semantic_weight],
        text_score: 0,
        composite_score: result.similarity * weights[:semantic_weight]
      }
    end

    # Add/enhance with full-text results
    fulltext_results.each do |result|
      if all_results[result.id]
        # Enhance existing result
        all_results[result.id][:text_score] = result.text_rank * weights[:text_weight]
        all_results[result.id][:composite_score] += result.text_rank * weights[:text_weight]
      else
        # Add new result
        all_results[result.id] = {
          embedding: result,
          semantic_score: 0,
          text_score: result.text_rank * weights[:text_weight],
          composite_score: result.text_rank * weights[:text_weight]
        }
      end
    end

    # Sort by composite score and apply usage ranking
    ranked_results = all_results.values
                               .sort_by { |r| -r[:composite_score] }
                               .first(weights[:limit] || 20)

    apply_usage_ranking(ranked_results)
  end
end
</code></pre>
<h2 id="advanced-search-features">Advanced Search Features</h2>
<h3 id="faceted-search">Faceted Search</h3>
<pre><code class="language-ruby">class FacetedSearch
  def search_with_facets(query, facets: {})
    base_results = SearchEngine.search_similar_content(query)

    # Apply facet filters
    filtered_results = apply_facet_filters(base_results, facets)

    # Calculate facet counts for UI
    facet_counts = calculate_facet_counts(base_results, facets.keys)

    {
      results: filtered_results,
      facets: facet_counts,
      total_count: filtered_results.size
    }
  end

  private

  def apply_facet_filters(results, facets)
    filtered = results.includes(embeddable: :document)

    facets.each do |facet_type, values|
      case facet_type
      when :content_type
        filtered = filtered.where(embeddable_type: values.map(&amp;:classify))
      when :classification
        filtered = filtered.joins(embeddable: :document)
                          .where(&quot;ragdoll_documents.metadata -&gt;&gt; 'classification' IN (?)&quot;, values)
      when :topics
        filtered = filtered.joins(embeddable: :document)
                          .where(&quot;ragdoll_documents.metadata -&gt; 'topics' ?| array[?]&quot;, values)
      when :date_range
        start_date, end_date = values
        filtered = filtered.joins(embeddable: :document)
                          .where(ragdoll_documents: { created_at: start_date..end_date })
      end
    end

    filtered
  end
end

# Usage example
results = FacetedSearch.search_with_facets(
  &quot;machine learning&quot;,
  facets: {
    content_type: ['text', 'image'],
    classification: ['research', 'technical'],
    topics: ['artificial intelligence', 'neural networks'],
    date_range: [1.year.ago, Time.current]
  }
)
</code></pre>
<h3 id="search-suggestions-and-autocomplete">Search Suggestions and Autocomplete</h3>
<pre><code class="language-ruby">class SearchSuggestions
  def suggest_queries(partial_query, limit: 10)
    # 1. Historical query suggestions
    historical = suggest_from_history(partial_query, limit: limit / 2)

    # 2. Content-based suggestions  
    content_based = suggest_from_content(partial_query, limit: limit / 2)

    # 3. Combine and rank suggestions
    combine_suggestions(historical, content_based).first(limit)
  end

  private

  def suggest_from_history(partial_query, limit:)
    SearchAnalytics.where(&quot;query ILIKE ?&quot;, &quot;#{partial_query}%&quot;)
                   .group(:query)
                   .order(&quot;COUNT(*) DESC&quot;)
                   .limit(limit)
                   .pluck(:query)
  end

  def suggest_from_content(partial_query, limit:)
    # Extract common phrases from content
    Embedding.where(&quot;content ILIKE ?&quot;, &quot;%#{partial_query}%&quot;)
             .select(&quot;regexp_split_to_table(content, E'\\\\s+') as word&quot;)
             .where(&quot;word ILIKE ?&quot;, &quot;#{partial_query}%&quot;)
             .group(&quot;word&quot;)
             .order(&quot;COUNT(*) DESC&quot;)
             .limit(limit)
             .pluck(&quot;word&quot;)
  end
end
</code></pre>
<h2 id="analytics-and-reporting">Analytics and Reporting</h2>
<h3 id="search-analytics-dashboard">Search Analytics Dashboard</h3>
<pre><code class="language-ruby">class SearchAnalytics
  def self.dashboard_metrics(date_range = 30.days.ago..Time.current)
    {
      total_searches: total_searches(date_range),
      unique_queries: unique_queries(date_range),
      top_queries: top_queries(date_range, limit: 10),
      search_trends: search_trends(date_range),
      content_type_distribution: content_type_distribution(date_range),
      average_results_per_search: average_results_per_search(date_range),
      user_engagement: user_engagement_metrics(date_range),
      performance_metrics: performance_metrics(date_range)
    }
  end

  def self.search_trends(date_range)
    group_by_day(date_range)
      .group(:query)
      .count
      .group_by { |k, v| k[0] }  # Group by date
      .transform_values { |queries| queries.sum { |_, count| count } }
  end

  def self.content_type_distribution(date_range)
    joins(embedding: :embeddable)
      .where(created_at: date_range)
      .group(&quot;embeddings.embeddable_type&quot;)
      .count
  end

  def self.user_engagement_metrics(date_range)
    {
      click_through_rate: calculate_ctr(date_range),
      average_session_searches: calculate_avg_session_searches(date_range),
      result_relevance_score: calculate_relevance_score(date_range),
      abandonment_rate: calculate_abandonment_rate(date_range)
    }
  end
end
</code></pre>
<h3 id="query-performance-monitoring">Query Performance Monitoring</h3>
<pre><code class="language-ruby">class SearchPerformanceMonitor
  def self.monitor_search_performance
    {
      embedding_generation_time: benchmark_embedding_generation,
      vector_search_time: benchmark_vector_search,
      fulltext_search_time: benchmark_fulltext_search,
      ranking_time: benchmark_ranking,
      total_search_time: benchmark_total_search,
      index_sizes: calculate_index_sizes,
      queue_depths: check_background_job_queues
    }
  end

  def self.benchmark_embedding_generation
    sample_queries = [&quot;machine learning&quot;, &quot;neural networks&quot;, &quot;data science&quot;]

    times = sample_queries.map do |query|
      Benchmark.realtime { EmbeddingService.generate_embedding(query) }
    end

    {
      average: times.sum / times.size,
      min: times.min,
      max: times.max,
      samples: times.size
    }
  end

  def self.benchmark_vector_search
    sample_vector = EmbeddingService.generate_embedding(&quot;test query&quot;)

    time = Benchmark.realtime do
      Embedding.select(&quot;embedding_vector &lt;=&gt; '#{sample_vector}' as distance&quot;)
               .order(&quot;embedding_vector &lt;=&gt; '#{sample_vector}'&quot;)
               .limit(20)
               .to_a
    end

    { duration: time, query_type: &quot;vector_similarity&quot; }
  end
end
</code></pre>
<h2 id="api-integration">API Integration</h2>
<h3 id="search-api-endpoints">Search API Endpoints</h3>
<pre><code class="language-ruby"># High-level search API
class SearchAPI
  def search(params)
    query = params[:query]
    options = extract_search_options(params)

    case params[:search_type]
    when 'semantic'
      SearchEngine.search_similar_content(query, options)
    when 'fulltext'
      FullTextSearchEngine.search(query, options)
    when 'hybrid'
      HybridSearchEngine.hybrid_search(query, options)
    when 'faceted'
      FacetedSearch.search_with_facets(query, facets: params[:facets])
    else
      # Default to hybrid search
      HybridSearchEngine.hybrid_search(query, options)
    end
  end

  def suggest(params)
    SearchSuggestions.suggest_queries(
      params[:partial_query],
      limit: params[:limit] || 10
    )
  end

  def analytics(params)
    date_range = parse_date_range(params[:date_range])
    SearchAnalytics.dashboard_metrics(date_range)
  end
end

# Usage examples
POST /api/search
{
  &quot;query&quot;: &quot;machine learning algorithms&quot;,
  &quot;search_type&quot;: &quot;hybrid&quot;,
  &quot;semantic_weight&quot;: 0.7,
  &quot;text_weight&quot;: 0.3,
  &quot;content_types&quot;: [&quot;text&quot;, &quot;image&quot;],
  &quot;similarity_threshold&quot;: 0.75,
  &quot;limit&quot;: 20,
  &quot;facets&quot;: {
    &quot;classification&quot;: [&quot;research&quot;, &quot;technical&quot;],
    &quot;topics&quot;: [&quot;AI&quot;, &quot;neural networks&quot;]
  }
}

GET /api/search/suggest?partial_query=machine&amp;limit=10
{
  &quot;suggestions&quot;: [
    &quot;machine learning&quot;,
    &quot;machine learning algorithms&quot;, 
    &quot;machine learning models&quot;,
    &quot;machine vision&quot;,
    &quot;machine translation&quot;
  ]
}
</code></pre>
<h2 id="configuration">Configuration</h2>
<h3 id="search-configuration">Search Configuration</h3>
<pre><code class="language-ruby">Ragdoll::Core.configure do |config|
  # Basic search settings
  config.search_similarity_threshold = 0.7
  config.max_search_results = 20
  config.enable_usage_analytics = true

  # Ranking weights
  config.ranking_weights = {
    similarity: 0.6,
    usage: 0.3,
    metadata: 0.1
  }

  # Hybrid search settings
  config.enable_fulltext_search = true
  config.fulltext_search_weight = 0.3
  config.semantic_search_weight = 0.7

  # Performance settings
  config.search_cache_ttl = 300.seconds
  config.embedding_cache_size = 1000
  config.analytics_batch_size = 100

  # Index configuration
  config.vector_index_lists = 100  # IVFFlat lists parameter
  config.enable_search_suggestions = true
  config.suggestion_cache_ttl = 3600.seconds
end
</code></pre>
<h2 id="best-practices_1">Best Practices</h2>
<h3 id="1-search-optimization">1. Search Optimization</h3>
<ul>
<li>Use appropriate similarity thresholds based on your content</li>
<li>Implement result caching for common queries</li>
<li>Monitor search performance and optimize indexes</li>
<li>Balance semantic and full-text search weights for your use case</li>
</ul>
<h3 id="2-analytics-implementation">2. Analytics Implementation</h3>
<ul>
<li>Track user interactions with search results</li>
<li>Monitor query performance and adjust configurations</li>
<li>Analyze search patterns to improve content organization</li>
<li>Use analytics to guide feature development</li>
</ul>
<h3 id="3-ranking-strategy">3. Ranking Strategy</h3>
<ul>
<li>Tune ranking weights based on user feedback</li>
<li>Consider domain-specific ranking factors</li>
<li>Implement A/B testing for ranking algorithms</li>
<li>Monitor ranking effectiveness through engagement metrics</li>
</ul>
<h3 id="4-performance-scaling">4. Performance Scaling</h3>
<ul>
<li>Implement search result caching</li>
<li>Use connection pooling for database access</li>
<li>Consider search result pre-computation for common queries</li>
<li>Monitor and scale background job processing</li>
</ul>
<p>The search and analytics system in Ragdoll provides enterprise-grade search capabilities that combine the power of semantic search with practical usage analytics and full-text search, enabling sophisticated document intelligence applications with excellent user experience.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>